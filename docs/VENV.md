# Віртуальні середовища Atlas

Цей документ описує стандарти роботи з віртуальними середовищами у проєкті Atlas.

## Стандартні віртуальні середовища

Проєкт Atlas використовує платформо-специфічні віртуальні середовища:

- **venv-macos**: Середовище для розробки та запуску на macOS (Python 3.13)
- **venv-linux**: Середовище для розробки та запуску на Linux (Python 3.12)

## Використання віртуальних середовищ

### Створення віртуального середовища

Для автоматичного створення правильного віртуального середовища використовуйте:

```bash
./scripts/install_requirements.sh
```

Цей скрипт автоматично визначить вашу платформу та створить відповідне віртуальне середовище.

### Активація віртуального середовища

Для активації віртуального середовища використовуйте:

```bash
# Для macOS
source scripts/use_macos.sh

# Для Linux
source scripts/use_linux.sh
```

### Міграція з нестандартних середовищ

Якщо ви раніше використовували нестандартне віртуальне середовище (наприклад, `venv`), ви можете мігрувати пакети до стандартного середовища:

```bash
./scripts/migrate_venv.sh venv
```

## Вимоги до пакетів

Встановлення пакетів відбувається відповідно до платформи:

- **macOS**: `requirements-macos.txt`
- **Linux**: `requirements-linux.txt`
- **Розробка**: `requirements-dev.txt` (для обох платформ)

## Скрипти для роботи з віртуальними середовищами

| Скрипт | Опис |
|--------|------|
| `install_requirements.sh` | Створює віртуальне середовище та встановлює залежності |
| `use_macos.sh` | Швидка активація macOS середовища |
| `use_linux.sh` | Швидка активація Linux середовища |
| `migrate_venv.sh` | Міграція пакетів з одного середовища в інше |
| `activate_venv.sh` | Інформація про активацію поточного середовища |
| `sync_requirements.sh` | Перевірка та синхронізація залежностей |
| `balance_requirements.sh` | Аналіз балансу залежностей між платформами |

## Рекомендації

1. **Завжди використовуйте віртуальне середовище**. Ніколи не встановлюйте пакети у глобальне середовище Python.

2. **Використовуйте стандартні назви середовищ** (`venv-macos` або `venv-linux`).

3. **Оновлюйте пакети в середовищах** через відповідні файли вимог.

4. **Документуйте нові залежності** у відповідних файлах вимог.

## Вирішення поширених проблем

### Проблеми з Jedi Language Server

Якщо у вашому IDE виникає помилка з Jedi (система автодоповнення Python):

```
Client Python Jedi: connection to server is erroring.
Cannot call write after a stream was destroyed
Shutting down server.
```

Виконайте наступні кроки:

1. Перевстановіть jedi-language-server в активному віртуальному середовищі:

   ```bash
   pip uninstall -y jedi-language-server jedi
   pip install jedi-language-server
   ```

2. Перезапустіть VS Code або ваше IDE.

3. Якщо проблема не зникла, перезапустіть VS Code з вимкненим розширенням Python, а потім увімкніть його знову:
   - VS Code: Command Palette → "Developer: Reload With Extensions Disabled"
   - Потім увімкніть розширення Python і перезапустіть VS Code.
